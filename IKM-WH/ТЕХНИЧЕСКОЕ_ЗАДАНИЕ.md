# Техническое задание
## Система управления музыкальным фестивалем

---

## 1. Общая информация

**Название проекта:** Festival Management System  
**Тип проекта:** Веб-приложение для управления музыкальным фестивалем  
**Архитектура:** Full-stack приложение (Backend API + Frontend SPA)  
**Цель:** Создание комплексной системы для организации и управления музыкальными фестивалями

---

## 2. Описание системы

Система предназначена для:
- Управления заявками на участие в фестивале
- Администрирования групп, мероприятий и контента
- Продажи мерчендайза и коллекционных карточек
- Управления афишами и постерами
- Отображения статистики и аналитики
- Публичного доступа к информации о фестивале

---

## 3. Технические требования

### 3.1 Backend (Node.js)

**Основной стек:**
- **Node.js** (LTS версия)
- **Express.js** - веб-фреймворк
- **TypeScript** - типизация
- **MongoDB** - база данных
- **Mongoose** - ODM для MongoDB

**Дополнительные технологии:**
- **JWT** - аутентификация и авторизация
- **bcrypt** - хеширование паролей
- **Multer** - загрузка файлов
- **Sharp** - обработка изображений
- **express-validator** - валидация данных
- **helmet** - безопасность
- **cors** - кросс-доменные запросы
- **express-rate-limit** - ограничение запросов

### 3.2 Frontend (React)

**Основной стек:**
- **React 19** - UI библиотека
- **TypeScript** - типизация
- **Vite** - сборщик и dev-сервер
- **React Router** - маршрутизация

**Дополнительные технологии:**
- **React Hook Form** - работа с формами
- **Zod** - валидация схем
- **Axios** - HTTP клиент
- **React Query** - управление состоянием сервера
- **Framer Motion** - анимации
- **Lucide React** - иконки
- **date-fns** - работа с датами

---

## 4. Архитектура системы

### 4.1 Backend архитектура

```
backend-node.js/
├── src/
│   ├── config/          # Конфигурация (БД, API)
│   ├── controllers/     # Контроллеры (обработка запросов)
│   ├── middleware/      # Middleware (аутентификация, валидация)
│   ├── models/          # Модели данных (Mongoose схемы)
│   ├── routes/          # Маршруты API
│   ├── services/        # Бизнес-логика
│   ├── types/           # TypeScript типы
│   ├── utils/           # Утилиты
│   ├── app.ts           # Конфигурация Express приложения
│   └── server.ts        # Точка входа сервера
├── scripts/             # Скрипты для разработки и тестирования
├── uploads/             # Загруженные файлы
└── swagger.yaml         # API документация
```

### 4.2 Frontend архитектура (Feature-Sliced Design)

```
frontend-react.js/
├── src/
│   ├── app/             # Конфигурация приложения
│   ├── entities/        # Бизнес-сущности
│   ├── features/        # Функциональности
│   ├── pages/           # Страницы приложения
│   ├── shared/          # Переиспользуемые компоненты
│   │   ├── api/         # API клиент
│   │   ├── components/  # UI компоненты
│   │   ├── hooks/       # Кастомные хуки
│   │   ├── layouts/     # Макеты страниц
│   │   └── ui/          # Базовые UI элементы
│   └── widgets/         # Составные компоненты
```

---

## 5. Функциональные требования

### 5.1 Роли пользователей

**Администратор (admin):**
- Полный доступ ко всем функциям системы
- Управление контентом и настройками
- Просмотр статистики и аналитики

**Публичный пользователь:**
- Просмотр информации о фестивале
- Подача заявок на участие
- Просмотр групп, мероприятий, мерча

### 5.2 Основные модули

#### 5.2.1 Аутентификация и авторизация
- Регистрация администраторов
- Вход/выход из системы
- JWT токены для авторизации
- Защита административных маршрутов

#### 5.2.2 Управление заявками
- Подача заявок на участие (публичная форма)
- Просмотр и управление заявками (админ)
- Изменение статуса заявок (новая/одобрена/отклонена)
- Фильтрация и поиск заявок

#### 5.2.3 Управление группами
- CRUD операции для музыкальных групп
- Информация о группах (название, жанр, участники)
- Социальные ссылки и изображения
- Связь с мероприятиями

#### 5.2.4 Управление мероприятиями
- CRUD операции для событий фестиваля
- Расписание мероприятий
- Информация о месте и времени проведения
- Статусы мероприятий

#### 5.2.5 Управление фестивалями
- Создание и настройка фестивалей
- Основная информация (дата, место, описание)
- Статусы фестивалей
- Связь с мероприятиями и группами

#### 5.2.6 Мерчендайз
- Каталог товаров фестиваля
- Управление ценами и остатками
- Категории товаров
- Изображения товаров

#### 5.2.7 Коллекционные карточки
- Наборы коллекционных карточек
- Карточки участников фестиваля
- Настройки продаж (цена, количество)
- Загрузка и обработка изображений

#### 5.2.8 Афиши и постеры
- Управление визуальными материалами
- Загрузка изображений
- Активация/деактивация постеров

#### 5.2.9 Контент-менеджмент
- Управление текстовым контентом сайта
- Ключ-значение система контента
- Поддержка различных типов контента

#### 5.2.10 Статистика и аналитика
- Общая статистика системы
- Активность пользователей
- Данные для дашборда администратора

---

## 6. API Спецификация

### 6.1 Базовая конфигурация
- **Base URL:** `http://localhost:3001/api`
- **Формат данных:** JSON
- **Аутентификация:** Bearer JWT токены
- **CORS:** Настроен для фронтенда

### 6.2 Основные эндпоинты

#### Аутентификация (`/api/auth`)
- `POST /register` - Регистрация администратора
- `POST /login` - Вход в систему
- `GET /profile` - Получение профиля пользователя
- `GET /validate` - Валидация JWT токена

#### Заявки (`/api/applications`)
- `GET /` - Список всех заявок (admin)
- `POST /` - Создание заявки (публичный)
- `GET /:id` - Получение заявки по ID (admin)
- `PUT /:id/status` - Изменение статуса заявки (admin)

#### Группы (`/api/groups`)
- `GET /` - Список групп
- `POST /` - Создание группы (admin)
- `GET /:id` - Получение группы по ID
- `PUT /:id` - Обновление группы (admin)
- `DELETE /:id` - Удаление группы (admin)

#### Мероприятия (`/api/events`)
- `GET /` - Список мероприятий
- `POST /` - Создание мероприятия (admin)
- `GET /:id` - Получение мероприятия по ID
- `PUT /:id` - Обновление мероприятия (admin)
- `DELETE /:id` - Удаление мероприятия (admin)

#### Фестивали (`/api/festivals`)
- `GET /` - Список фестивалей
- `POST /` - Создание фестиваля (admin)
- `GET /:id` - Получение фестиваля по ID
- `PUT /:id` - Обновление фестиваля (admin)
- `DELETE /:id` - Удаление фестиваля (admin)

#### Мерчендайз (`/api/merch`)
- `GET /` - Каталог товаров
- `POST /` - Добавление товара (admin)
- `GET /:id` - Получение товара по ID
- `PUT /:id` - Обновление товара (admin)
- `PATCH /:id/stock` - Обновление остатков (admin)
- `DELETE /:id` - Удаление товара (admin)

#### Карточки (`/api/cards`)
- `GET /` - Список наборов карточек
- `POST /` - Создание набора (admin)
- `GET /:id` - Получение набора по ID
- `PUT /:id` - Обновление набора (admin)
- `DELETE /:id` - Удаление набора (admin)

#### Карточки участников (`/api/participant-cards`)
- `GET /` - Список карточек участников
- `POST /` - Создание карточек (admin)
- `GET /:id` - Получение карточек по ID
- `PUT /:id` - Обновление карточек (admin)
- `DELETE /:id` - Удаление карточек (admin)

#### Постеры (`/api/posters`)
- `GET /` - Список постеров
- `POST /` - Загрузка постера (admin)
- `GET /:id` - Получение постера по ID
- `PUT /:id` - Обновление постера (admin)
- `DELETE /:id` - Удаление постера (admin)

#### Контент (`/api/content`)
- `GET /` - Весь контент сайта
- `POST /` - Создание контента (admin)
- `GET /:id` - Получение контента по ID
- `PUT /:id` - Обновление контента (admin)
- `DELETE /:id` - Удаление контента (admin)

#### Статистика (`/api/stats`)
- `GET /` - Общая статистика (admin)
- `GET /activity` - Активность пользователей (admin)

---

## 7. Модели данных

### 7.1 User (Пользователь)
```typescript
interface IUser {
  id: string;
  name: string;
  email: string;
  passwordHash: string;
  role: 'admin';
  createdAt: Date;
}
```

### 7.2 FestivalApplication (Заявка на участие)
```typescript
interface IFestivalApplication {
  id: string;
  groupName: string;
  artistName?: string;
  bandName?: string;
  contactTelegram: string;
  contactPhone: string;
  description?: string;
  socialLinks?: SocialLinks;
  genre?: string;
  members?: string[];
  status: 'pending' | 'approved' | 'rejected';
  submittedAt: Date;
  reviewedAt?: Date;
  reviewedBy?: string;
  notes?: string;
}
```

### 7.3 Group (Группа)
```typescript
interface IGroup {
  id: string;
  name: string;
  genre?: string;
  description?: string;
  members?: string[];
  image?: string;
  vkLink?: string;
  tgLink?: string;
  socialLinks?: SocialLinks;
}
```

### 7.4 Event (Мероприятие)
```typescript
interface IEvent {
  id: string;
  title: string;
  description?: string;
  date: Date;
  time: string;
  venue: string;
  address: string;
  performers: string[];
  image?: string;
  status: 'upcoming' | 'ongoing' | 'completed' | 'cancelled';
  groupId?: string;
}
```

### 7.5 Festival (Фестиваль)
```typescript
interface IFestival {
  id: string;
  name: string;
  date: Date;
  venue: string;
  description?: string;
  image?: string;
  time?: string;
  address?: string;
  performers?: string[];
  status: 'upcoming' | 'ongoing' | 'completed' | 'cancelled';
}
```

### 7.6 MerchItem (Товар)
```typescript
interface IMerchItem {
  id: string;
  title: string;
  description?: string;
  price: number;
  image?: string;
  stock: number;
  category?: string;
}
```

### 7.7 CardSet (Набор карточек)
```typescript
interface ICardSet {
  id: string;
  title: string;
  festivalId: string;
  cardsInSet: number;
  setsAvailable: number;
  price: number;
  image?: string;
  cards?: Array<{
    name: string;
    image?: string;
    description?: string;
  }>;
}
```

### 7.8 ParticipantCard (Карточки участников)
```typescript
interface IParticipantCard {
  id: string;
  festivalId: string;
  groupName: string;
  eventId: string;
  cards: Array<{
    originalName: string;
    filename: string;
    mimetype: string;
    size: number;
    compressedSize: number;
    compressionRatio: number;
    uploadedAt: Date;
  }>;
  settings: {
    price: number;
    setsAvailable: number;
    isActive: boolean;
  };
}
```

### 7.9 Poster (Постер)
```typescript
interface IPoster {
  id: string;
  title: string;
  image: string;
  description?: string;
  eventDate?: Date;
  isActive: boolean;
}
```

---

## 8. Нефункциональные требования

### 8.1 Производительность
- Время отклика API: не более 500ms для большинства запросов
- Поддержка одновременной работы до 100 пользователей
- Оптимизация изображений при загрузке

### 8.2 Безопасность
- JWT аутентификация с истечением токенов
- Хеширование паролей с помощью bcrypt
- Rate limiting для предотвращения злоупотреблений
- CORS защита
- Валидация всех входящих данных
- Helmet для установки заголовков безопасности

### 8.3 Масштабируемость
- Модульная архитектура для легкого расширения
- Разделение на слои (контроллеры, сервисы, модели)
- Готовность к контейнеризации (Docker)
- Поддержка горизонтального масштабирования

### 8.4 Надежность
- Централизованная обработка ошибок
- Логирование важных операций
- Валидация данных на всех уровнях
- Graceful shutdown сервера

### 8.5 Удобство использования
- Интуитивный интерфейс администратора
- Адаптивный дизайн для мобильных устройств
- Быстрая загрузка страниц
- Понятные сообщения об ошибках

---

## 9. Развертывание и конфигурация

### 9.1 Переменные окружения

**Backend (.env):**
```env
NODE_ENV=development
PORT=3001
MONGO_URI=mongodb://localhost:27017/festival-app
JWT_SECRET=your_jwt_secret_key_change_in_production
JWT_EXPIRES_IN=7d
CORS_ORIGIN=http://localhost:5173
```

**Frontend (.env):**
```env
VITE_API_URL=http://localhost:3001/api
```

### 9.2 Требования к системе
- Node.js 18+ (LTS)
- MongoDB 5.0+
- Минимум 2GB RAM
- 10GB свободного места на диске

### 9.3 Установка и запуск

**Backend:**
```bash
cd backend-node.js
npm install
npm run dev
```

**Frontend:**
```bash
cd frontend-react.js
pnpm install
pnpm run dev
```

---

## 10. Тестирование

### 10.1 Backend тестирование
- Unit тесты для сервисов и утилит
- Integration тесты для API эндпоинтов
- Тестирование аутентификации и авторизации
- Валидация данных

### 10.2 Frontend тестирование
- Компонентное тестирование
- E2E тестирование критических путей
- Тестирование форм и валидации
- Тестирование интеграции с API

---

## 11. Документация

### 11.1 API документация
- OpenAPI 3.0.3 спецификация (swagger.yaml)
- Подробное описание всех эндпоинтов
- Примеры запросов и ответов
- Схемы данных

### 11.2 Техническая документация
- README файлы для каждого модуля
- Инструкции по установке и настройке
- Руководство по разработке
- Архитектурные решения

---

## 12. Поддержка и развитие

### 12.1 Планируемые улучшения
- Система уведомлений
- Интеграция с платежными системами
- Мобильное приложение
- Расширенная аналитика
- Многоязычность

### 12.2 Техническая поддержка
- Мониторинг производительности
- Резервное копирование данных
- Обновления безопасности
- Масштабирование при росте нагрузки

---

## 13. Заключение

Система управления музыкальным фестивалем представляет собой современное, масштабируемое решение, построенное на актуальных технологиях. Архитектура системы позволяет легко добавлять новые функции и адаптировать систему под изменяющиеся требования.

Проект готов к развертыванию в продакшн среде и может служить основой для создания более сложных систем управления мероприятиями.